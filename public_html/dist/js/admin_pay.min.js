!function(){function o(e,t){if((t=(t=(t=(t=(t=(t=t.replace(/YYYY/g,e.getFullYear())).replace(/MM/g,("0"+(e.getMonth()+1)).slice(-2))).replace(/DD/g,("0"+e.getDate()).slice(-2))).replace(/hh/g,("0"+e.getHours()).slice(-2))).replace(/mm/g,("0"+e.getMinutes()).slice(-2))).replace(/ss/g,("0"+e.getSeconds()).slice(-2))).match(/S/g))for(var a=("00"+e.getMilliseconds()).slice(-3),n=t.match(/S/g).length,o=0;o<n;o++)t=t.replace(/S/,a.substring(o,o+1));return t}function t(e,t,a){switch(a){case"YYYY":e.setYear(e.getYear()+t);break;case"MM":e.setMonth(e.getMonth()+t);break;case"hh":e.setHours(e.getHours()+t);break;case"mm":e.setMinutes(e.getMinutes()+t);break;case"ss":e.setSeconds(e.getSeconds()+t);break;default:e.setDate(e.getDate()+t)}return e}Cookies.get("payMonth")?l=Cookies.get("payMonth"):(l=new Date).setDate(1);var a,l,r=Cookies.get("payMonthDiff"),n=function(){return $.ajax({url:"../data/columns/pay",dataType:"json",type:"POST"})},s={renderDate:function(){var e,t,a,n=new Date(l);a=0<end_day?((a=new Date(l)).setMonth(a.getMonth()-1),e=end_day+1,e=o(a,"YYYY年MM月")+e+"日",t=o(n,"YYYY年MM月")+end_day+"日",new Date(a.getFullYear(),a.getMonth()+1,0).getDate()-end_day+end_day):(e=o(n,"YYYY年MM月")+"01日",t=o(new Date(n.getFullYear(),n.getMonth()+1,0),"YYYY年MM月DD日"),new Date(n.getFullYear(),n.getMonth()+1,0).getDate()),$("#to_from_date").text(e+"から"+t+"までの"+a+"日間"),$("#month").val(o(n,"YYYY年MM月")),Cookies.set("payMonth",l),Cookies.set("payMonthDiff",r)},renderTableColumns:new Promise(function(t,e){n().done(function(e){a=new Tabulator("#data_table",{height:"calc(100vh - 260px)",columns:e,tooltips:function(e){var t=e.getColumn();"work_num"!=t._column.field&&"work_time"!=t._column.field||(e.getElement().style.color="#1591a2")},invalidOptionWarnings:!1}),t(),a.hideColumn("group1_name"),a.hideColumn("group2_name"),a.hideColumn("group3_name"),a.hideColumn("entry_date"),a.hideColumn("interval"),a.hideColumn("start_month"),a.hideColumn("paid_month"),a.hideColumn("put_paid"),a.hideColumn("work_hour"),a.hideColumn("total_work_hour")})}),renderTableData:function(){o(new Date(l),"YYYY-MM")===o(new Date,"YYYY-MM")?($("#this_month").addClass("disable"),$("#this_month_mark").addClass("this-month"),$("#this_month_mark").text("今月"),$("#add_month").addClass("disable"),r=0):($("#this_month").removeClass("disable"),$("#this_month_mark").removeClass("this-month"),$("#add_month").removeClass("disable"),0<r?$("#this_month_mark").text(r+"ヶ月後"):$("#this_month_mark").text(Math.abs(r)+"ヶ月前")),a.replaceData("../data/admin_pay/table_data",{year:o(new Date(l),"YYYY"),month:o(new Date(l),"MM"),end_day:end_day},"POST")}};$(function(){s.renderDate(),Promise.all([s.renderTableColumns]).then(function(){s.renderTableData()}),$("#less_month").on("click",function(e){l=t(new Date(l),-1,"MM"),r--,a.clearData(),s.renderTableData(),s.renderDate()}),$("#add_month").on("click",function(e){l=t(new Date(l),1,"MM"),r++,a.clearData(),s.renderDate(),s.renderTableData()}),$("#this_month_mark, #this_month").on("click",function(e){l=new Date,a.clearData(),s.renderTableData(),s.renderDate()}),$("#users_table_btn").on("click",function(){$("#users_table_area").toggleClass("detaile_view"),$(this).toggleClass("on"),a.toggleColumn("group1_name"),a.toggleColumn("group2_name"),a.toggleColumn("group3_name"),a.toggleColumn("entry_date"),a.toggleColumn("interval"),a.toggleColumn("start_month"),a.toggleColumn("paid_month"),a.toggleColumn("put_paid")})})}();