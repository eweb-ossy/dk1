!function(){var t=0;function o(e){var e=new Date(e),t=e.getFullYear().toString().padStart(4,"0"),a=(e.getMonth()+1).toString().padStart(2,"0"),e=e.getDate().toString().padStart(2,"0"),n=new Date,i=n.getFullYear().toString().padStart(4,"0"),o=(n.getMonth()+1).toString().padStart(2,"0"),n=n.getDate().toString().padStart(2,"0");return Math.floor((Number(i+o+n)-Number(t+a+e))/1e4)}var a=function(){return $.ajax({url:"../../data/admin_user_detail/user_data",dataType:"json",type:"POST",data:{user_id:userId}})},e=function(){return $.ajax({type:"POST",dataType:"json",url:"../../data/admin_user_detail/save_mypage",data:{id:$('input[name="id"]').val(),name_sei:$('input[name="name_sei"]').val(),name_mei:$('input[name="name_mei"]').val(),kana_sei:$('input[name="kana_sei"]').val(),kana_mei:$('input[name="kana_mei"]').val(),sex:$('input[name="sex"]:checked').val(),birth_date:$('input[name="birth_date"]').val(),zip_code:$('input[name="zip_code"]').val(),address:$('input[name="address"]').val(),phone_number1:$('input[name="phone_number1"]').val(),phone_number2:$('input[name="phone_number2"]').val(),email1:$('input[name="email1"]').val(),email2:$('input[name="email2"]').val(),user_password:$('input[name="user_password"]').val()}})},n=function(){var e={system_id:sysId,user_id:userId};socket.emit("notice_client_to_server",e),socket.on("notice_server_to_client",function(e){var r=0,d=0;$.each(e,function(e,t){if(t.user_id!=userId&&t.high_user_id.indexOf(String(userId))<0)return!0;0==t.notice_status&&r++,1==t.notice_status&&(t.user_id,userId),2==t.notice_status&&(t.user_id,userId,d++),t.notice_flag,t.notice_flag,t.notice_flag,t.notice_flag,t.notice_flag,t.notice_flag,t.notice_flag,t.notice_flag,t.notice_flag,t.user_id!=userId&&(t.user_id,t.user_name);var a=new Date(t.to_date),n=a.getFullYear(),i=a.getMonth()+1,o=a.getDate(),s=["日","月","火","水","木","金","土"][a.getDay()];("0"+i).slice(-2),("0"+o).slice(-2);t.end_date&&(n=(a=new Date(t.end_date)).getFullYear(),i=a.getMonth()+1,o=a.getDate(),s=["日","月","火","水","木","金","土"][a.getDay()],("0"+i).slice(-2),("0"+o).slice(-2))}),$("#notice_count_new, .badge-text1").hide(),$("#notice_count_ng, .badge-text2").hide(),0<r&&($("#notice_count_new, .badge-text1").show(),$("#notice_count_new").text(r)),0<d&&($("#notice_count_ng, .badge-text2").show(),$("#notice_count_ng").text(d))})},i=function(e){"0000-00-00"!==e.entry_date&&e.entry_date,"0000-00-00"!==e.resign_date&&e.resign_date;var t="0000-00-00"===e.birth_date?"":e.birth_date,a=($('input[name="id"]').val(e.id),null===e.kana_sei?"":e.kana_sei),n=null===e.kana_mei?"":e.kana_mei,i=null===e.zip_code?"":e.zip_code;$('input[name="user_id"]').val(e.user_id),$('input[name="name_sei"]').val(e.name_sei),$('input[name="name_mei"]').val(e.name_mei),$('input[name="kana_sei"]').val(a),$('input[name="kana_mei"]').val(n),$('input[name="zip_code"]').val(i),$('input[name="address"]').val(e.address),$('[name="sex"][value="'+e.sex+'"]').prop("checked",!0),$('input[name="birth_date"]').val(t),$('input[name="phone_number1"]').val(e.phone_number1),$('input[name="phone_number2"]').val(e.phone_number2),$('input[name="email1"]').val(e.email1),$('input[name="email2"]').val(e.email2),t?($("#old").val(o(t)+"歳"),datepicker.setDate(t,"Y-m-d")):$("#old").val("")};$(function(){n(),$(document).on("click",".navbar-toggler",function(){var e;t=1===t?($("html").removeClass("nav-open"),$(".close-layer").remove(),setTimeout(function(){$(this).removeClass("toggled")},400),0):(setTimeout(function(){$(this).addClass("toggled")},430),e=$('<div class="close-layer"></div>'),0!=$("body").find(".main-panel").length?e.appendTo(".main-panel"):$("body").hasClass("off-canvas-sidebar")&&e.appendTo(".wrapper-full-page"),setTimeout(function(){e.addClass("visible")},100),e.click(function(){$("html").removeClass("nav-open"),t=0,e.removeClass("visible"),setTimeout(function(){e.remove(),$(this).removeClass("toggled")},400)}),$("html").addClass("nav-open"),1)}),datepicker=flatpickr("#birth_date",{dateFormat:"Y-m-d",defaultDate:"1990-01-01",onChange:function(e,t){t&&$("#old").val(o(t)+"歳")}}),a().done(function(e){i(e)}),$("#profile_submit").on("click",function(){$(this).prop("disabled",!0),e().done(function(e){switch(e.message){case"ok_edit":siiimpleToast.message("修正登録完了",{position:"top|right"}),a().done(function(e){i(e)});break;case"err_update":siiimpleToast.alert("修正登録エラー",{position:"top|right"});break;default:siiimpleToast.alert("通信エラー",{position:"top|right"})}$("#profile_submit").prop("disabled",!1)})}),$(document).on("click",".header-menu-btn",function(){$(this).next(".dropdown-menu").toggleClass("show")}),$(document).click(function(e){$(e.target).closest(".dropdown-menu").length||$(e.target).closest(".header-menu-btn").length||$(".dropdown-menu").removeClass("show")}),$(document).on("click",".dropdown-item",function(){Cookies.set("notice_id",$(this).attr("id")),location.href="/mypage_notice"})})}();